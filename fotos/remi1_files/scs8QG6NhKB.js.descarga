if (self.CavalryLogger) { CavalryLogger.start_js(["0gAwA"]); }

__d("getInstalledRelatedApps",["regeneratorRuntime"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!(typeof navigator.getInstalledRelatedApps!=="function")){a.next=2;break}return a.abrupt("return",null);case 2:a.next=4;return b("regeneratorRuntime").awrap(navigator.getInstalledRelatedApps());case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},null,this)}}),null);
__d("MAnimatedScroll",["MAnimator","MViewport","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";f.scrollToTop=a;f.scrollToNode=c;var g=null,h=500;function i(a){a&&b("clearTimeout")(a);return null}function j(a,c,d){g=i(g);c=c.duration===null||c.duration===void 0?h:c.duration;var e=b("MViewport").getScrollTop();if(e===a)return;var f=e;b("MAnimator").play(e,a,c,function(c){var d=b("MAnimator").easeInOutCubic((c-f)/(e-a));d=Math.round((c-f)*d+f);f=c;b("MViewport").scrollToY(d)});d&&(g=b("setTimeoutAcrossTransitions")(d,c))}function a(a,b){j(0,a,b)}function c(a,b,c,d){j(a.offsetTop-b,c,d)}}),null);
__d("MStoriesProductionInfo",[],(function(a,b,c,d,e,f){"use strict";a={_uploadStatus:null,_uri:null,_rotate:0,setUploadStatus:function(a){this._uploadStatus=a},getUploadStatus:function(){return this._uploadStatus},setChosenImage:function(a){var b=a.URI;a=a.rotate;this._uri=b;this._rotate=a},getChosenImage:function(){return{URI:this._uri,rotate:this._rotate}}};e.exports=a}),null);
__d("MStoriesUploadStatus",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({IDLE:0,UPLOADING:1,FAILED:2});e.exports=a}),null);
__d("MStoriesStratcomEvents",[],(function(a,b,c,d,e,f){"use strict";a="fb:stories:mobile:story:viewer:story:deleted";f.DELETE_BUCKET=a;b="fb:stories:mobile:story:viewer:delete:thread";f.DELETE_THREAD=b;c="fb:stories:mobile:story:viewer:story:muted";f.MUTE_BUCKET=c;d="m:stories:thread:media:pause";f.MEDIA_PAUSE=d;e="m:stories:thread:media:pause:with:cover";f.MEDIA_PAUSE_WITH_COVER=e;a="m:stories:thread:media:play";f.MEDIA_PLAY=a;b="fb:stories:mobile:story:viewer:nextBucket";f.NEXT_BUCKET=b;c="fb:stories:mobile:story:viewer:nextCard";f.NEXT_CARD=c;d="fb:stories:mobile:story:viewer:card:changed:by:viewer:sheet";f.CARD_CHANGED_BY_VIEWER_SHEET=d;e="fb:stories:mobile:story:viewer:prevBucket";f.PREV_BUCKET=e;a="fb:stories:mobile:story:viewer:click:story:in:viewer:sheet";f.CLICK_STORY_IN_VIEWER_SHEET=a;b="m:stories:card:modal:hide";f.THREAD_MODAL_HIDE=b;c="m:video:player:play";f.VIDEO_PLAY=c;d="m:video:player:playing";f.VIDEO_PLAYING=d;e="m-stories-viewer-sheet-hide";f.VIEWER_SHEET_HIDE=e;a="m-stories-viewer-sheet-hidden";f.VIEWER_SHEET_HIDDEN=a;b="m-stories-viewer-sheet-open";f.VIEWER_SHEET_OPEN=b;c="m-stories-viewer-sheet-image-changed-by-scrolling";f.VIEWER_SHEET_IMAGE_CHANGED_BY_SCROLLING=c;d="m-stories-viewer-sheet-native-template-changed-by-scrolling";f.VIEWER_SHEET_NATIVE_TEMPLATE_CHANGED_BY_SCROLLING=d;e="m:stories:production:preview-controls:hide";f.PRODUCTION_PREVIEW_CONTROLS_HIDE=e;a="m:stories:production:preview-controls:show";f.PRODUCTION_PREVIEW_CONTROLS_SHOW=a;b="m:stories:production:text-controls:hide";f.PRODUCTION_TEXT_CONTROLS_HIDE=b;c="m:stories:production:text-controls:show";f.PRODUCTION_TEXT_CONTROLS_SHOW=c;d="m:stories:production:text-overlay:remove";f.PRODUCTION_TEXT_OVERLAY_REMOVE=d;e="m:stories:production:text-overlay:focus";f.PRODUCTION_TEXT_OVERLAY_FOCUS=e;a="m:stories:swipe:left";f.SWIPE_LEFT=a;b="m:stories:swipe:right";f.SWIPE_RIGHT=b;c="m:stories:swipe:down";f.SWIPE_DOWN=c;d="m:stories:swipe:up";f.SWIPE_UP=d;e="fb:stories:mobile:story:viewer:swipe:reply";f.SWIPE_REPLY=e;a="m:stories:toast:showing";f.TOAST_SHOWING=a;b="m:stories:toast:hiding";f.TOAST_HIDING=b;c="m:stories:upload:failed";f.UPLOAD_FAILED=c;d="m:stories:upload:success";f.UPLOAD_SUCCESS=d;e="m:stories:overlay-interaction:pause";f.OVERLAY_INTERACTION_PAUSE=e;a="m:stories:overlay-interaction:play";f.OVERLAY_INTERACTION_PLAY=a;b="m:stories:set-bucket-ids-use-for-testing-only";f.SET_BUCKET_IDS_USE_FOR_TESTING_ONLY=b}),null);
__d("MStoriesUtils",["cx","fbt","DOM","MPageController","MStoriesStratcomEvents","MStoriesUIConstants","Stratcom","Style","UserAgent","gkx","goURI"],(function(a,b,c,d,e,f,g,h){"use strict";var i={UNSET:"UNSET",PUBLIC:"PUBLIC",FRIENDS_AND_CONNECTIONS:"FRIENDS_AND_CONNECTIONS",FRIENDS:"FRIENDS",CUSTOM:"CUSTOM"},j=[],k={displaysExifRotationCorrectly:function(){return b("UserAgent").isBrowser("Chrome >= 81")||b("UserAgent").isBrowser("Mobile Safari >= 13.1")||b("UserAgent").isBrowser("Safari >= 13.1")},getDocumentScale:function(){var a=window.visualViewport;return a?a.scale:document.body?document.body.clientWidth/window.innerWidth:1},listenForThreadTransition:function(a){var c,d;c=[(c=b("Stratcom")).listen("click","m-stories-next-button",a),c.listen("click","m-stories-prev-button",a),c.listen((d=b("MStoriesStratcomEvents")).CARD_CHANGED_BY_VIEWER_SHEET,null,a),c.listen(d.NEXT_CARD,null,a),c.listen(d.NEXT_BUCKET,null,a),c.listen(d.PREV_BUCKET,null,a)];return c},iOSVersion:function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return a==null?null:parseInt(a[1],10)}return null},goBackToHomepage:function(){if(j.length>0){b("MPageController").load(j.pop(),{expiration:b("MStoriesUIConstants").REFRESH_TIMEOUT_IN_MS});return}var a=document.getElementsByClassName("_129-")[0],c=this.iOSVersion();c=c&&c<10;!c&&(a||b("gkx")("709647"))?(b("DOM").show(a),b("MPageController").load("/",{expiration:b("MStoriesUIConstants").REFRESH_TIMEOUT_IN_MS})):b("goURI")("/")},getCropInfo:function(a,b,c,d,e){var f={sx:0,sy:0,sWidth:a,sHeight:b,dWidth:c,dHeight:d};if(!e){e=a/b;e=c/e;e<=d?f.dHeight=e:(f.sy=(e-d)/2*(b/e),f.sHeight=b-f.sy*2)}else{e=c/b*a;e<=d?f.dHeight=e:(f.sx=(e-d)/2*(a/d),f.sWidth=a-f.sx*2)}return f},getAudienceModeHeaderMapping:function(a){switch(a){case i.PUBLIC:return h._("P\u00fablico");case i.FRIENDS_AND_CONNECTIONS:return h._("Amigos y conexiones");case i.FRIENDS:return h._("Amigos");case i.CUSTOM:return h._("Personalizado");default:return h._("Sin configurar")}},touchMoveListener:function(a){a.touches.length===1&&k.getDocumentScale()===1&&a.preventDefault()},truncateParagraphToFitContainer:function(a){var c=a.textContent,d=!1;do{var e=b("Style").get(a,"max-height");b("Style").set(a,"max-height","unset");var f=a.clientHeight;b("Style").set(a,"maxHeight",e);e=a.clientHeight;if(f<=e){d=!0;break}c=c.slice(0,-1);a.textContent=c+"..."}while(!d)},setExitUri:function(a,b){b===void 0&&(b=!1);if(a==null)return;b?j.push(a):j=[a]},getInnerText:function(a){var b="",c=!0;for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];e.nodeType===Node.TEXT_NODE?(b+=e.textContent,c=!1):e.nodeName.toLowerCase()==="br"&&!c?(b+="\n",c=!0):e.nodeName.toLowerCase()!=="br"&&(c||(b+="\n"),b+=e.textContent,b+="\n",c=!0)}return b},isIOS:function(){if(!navigator.userAgent)return!1;return navigator.userAgent.match(/iPhone/)||navigator.userAgent.match(/iPod/)||navigator.userAgent.match(/iPad/)?!0:!1}};e.exports=k}),null);
__d("XMStoriesProductionPreviewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stories/preview/",{session_key:{type:"String"}})}),null);
__d("MStoriesCreation",["fbt","Promise","Bootloader","MPageController","MStoriesProductionInfo","MStoriesUploadStatus","MStoriesUtils","UserAgent","WebFunnelLogger","XMStoriesProductionPreviewController","nullthrows","promiseDone","uuid"],(function(a,b,c,d,e,f,g){function h(a){return new(b("Promise"))(function(b){var c=new FileReader();c.onload=function(a){return b(a.target.result)};c.readAsDataURL(a)})}a=function(){function a(c){var d=this;this.$3="";this.$5=function(a){a=b("MStoriesProductionInfo").getUploadStatus();if(a===b("MStoriesUploadStatus").UPLOADING){b("Bootloader").loadModules(["MStoriesToast"],function(a){a.showDefaultToast(g._("Subiendo historia"))},"MStoriesCreation");return}d.$3=b("uuid")();new(b("WebFunnelLogger"))("FBStoriesMTouchTrayProductionFunnelDefinition").markStart().setSessionKey(d.$3).setAction("Production item select").log();b("MStoriesProductionInfo").setUploadStatus(b("MStoriesUploadStatus").IDLE);d.$2.click()};var e=0,f=b("UserAgent").isBrowser("Firefox")&&b("UserAgent").isPlatform("Android");this.$1=c.item;this.$2=c.input;a.$4=this;this.$1.addEventListener("click",this.$5,!0);this.$2&&this.$2.addEventListener("change",function(a){a=a.target.files;var c=null;for(var g=0;g<a.length;g++)if(a[g].type.match(/^image\//)){c=a[g];break}if(c!==null){d.$6();var i=function(a){e=a;if(f)b("promiseDone")(h(b("nullthrows")(c)),function(a){a=a;b("MStoriesProductionInfo").setChosenImage({URI:a,rotate:e});d.$7()});else{a=URL.createObjectURL(b("nullthrows")(c));b("MStoriesProductionInfo").setChosenImage({URI:a,rotate:e});d.$7()}};b("MStoriesUtils").displaysExifRotationCorrectly()?i(0):b("Bootloader").loadModules(["ImageExifRotation"],function(a){a.getRotation(c,i)},"MStoriesCreation")}})}var c=a.prototype;c.$6=function(){b("MStoriesUtils").setExitUri(window.location.href,!0)};c.$7=function(){new(b("WebFunnelLogger"))("FBStoriesMTouchTrayProductionFunnelDefinition").setAction("Opening production preview").setSessionKey(this.$3).log();var a=b("XMStoriesProductionPreviewController").getURIBuilder().setString("session_key",this.$3).getURI();b("MPageController").load(a);this.$3=""};return a}();e.exports=a;a.$4=null}),null);
__d("FBLoomEventBuffer",["performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";var g;a=function(){function a(){this.$1=[]}var c=a.prototype;c.addEvent=function(a,c){this.$1.push({event:a,timestamp:(a=c)!=null?a:(g||(g=b("performanceAbsoluteNow")))()})};c.flushEvents=function(){return this.$1};return a}();e.exports=a}),null);
__d("FBLoomSampling",["WebLoomConfig"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){a=a==="QPL"?b("WebLoomConfig").adaptive_config.qpl:b("WebLoomConfig").adaptive_config.interactions;d=d!=null?c+"."+d:""+c;d=a.events[d];if(d!=null)return d;a=(d=a.modules[c>>16&65535])!=null?d:0;return a}e.exports={getSampleRate:a}}),null);
__d("FBLoomSerializer",["SnappyCompressUtil"],(function(a,b,c,d,e,f){"use strict";f.isSupported=g;f.serialize=a;function g(){return!window.Uint8Array||!window.btoa?!1:!0}function a(a,c,d){c=c.flushEvents();if(!g())return null;var e=a.start_time_us,f=a.end_time_us,h=e/1e3,i=f/1e3;if(d!=null){var j=h-d.stats.timeOrigin,k=i-d.stats.timeOrigin;d.trace.samples=d.trace.samples.filter(function(a){return a.timestamp>=j&&a.timestamp<=k})}var l=JSON.stringify(a)+"\n{}\n"+JSON.stringify(d||null)+"\n",m=0;c.forEach(function(a){var b=Math.round(a.timestamp*1e3);if(b<e||b>f)return;var c=b-m;m=b;b=a.event;a=[c,b.type];switch(b.type){case"QPL_ANNOTATION":a.push(b.markerId);a.push(b.instanceKey);a.push(b.annotationKey);a.push(b.annotationValue);break;case"QPL_START":a.push(b.markerId);a.push(b.instanceKey);break;case"QPL_END":a.push(b.markerId);a.push(b.instanceKey);a.push(b.action);break;case"QPL_POINT":a.push(b.markerId);a.push(b.instanceKey);a.push(b.name);b.data!=null&&a.push(b.data);break;case"RESOURCE_TIMING_START":a.push(b.resourceType);a.push(b.resourceId);a.push(b.resourceName);a.push(b.encodedSize);a.push(b.decodedSize);a.push(b.transferSize);break;case"RESOURCE_TIMING_END":a.push(b.resourceType);a.push(b.resourceId);break;case"RESOURCE_TIMING_POINT":a.push(b.resourceType);a.push(b.resourceId);a.push(b.pointName);break;case"INTERACTION_TRACE_START":a.push(b.traceId);a.push(b.execUnitName);a.push(b.blockName);a.push(b.blockType);a.push(b.traceType);break;case"INTERACTION_TRACE_END":a.push(b.traceId);a.push(b.execUnitName);a.push(b.blockName);a.push(b.blockType);a.push(b.traceType);a.push(b.blockAnnotations);break;case"INTERACTION_TRACE_POINT":a.push(b.traceId);a.push(b.execUnitName);a.push(b.blockName);a.push(b.pointName);a.push(b.pointAnnotations);break;case"VISUAL_COMPLETION_RECT":a.push(b.elementType);a.push(b.depth);a.push(b.x);a.push(b.y);a.push(b.width);a.push(b.height);a.push(b.mutationType);break;case"VISUAL_COMPLETION_PROGRESS":a.push(b.progress);break;case"JS_SCHEDULER_QUEUE":a.push(b.priority);a.push(b.queueSize);break}l+=JSON.stringify(a)+"\n"});return b("SnappyCompressUtil").compressStringToSnappy(l)}}),null);
__d("FBLoomStaticResourceFileTypes",[],(function(a,b,c,d,e,f){"use strict";f.isStaticResourceFileType=a;var g={js:"js",css:"css",wasm:"wasm",woff:"woff",woff2:"woff2",otf:"otf",eot:"eot",ttf:"ttf"};f.FBLoomStaticResourceFileTypes=g;function a(a){return Object.prototype.hasOwnProperty.call(g,a)}}),null);
__d("sanitizeURIStringForLoom",["FBLoomStaticResourceFileTypes","URI","UserAgent","isCdnURI"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g,h=new Map(),i=0,j=/(\d{4,})/gm,k=/([a-f0-9]{8,})/gm;function l(a){a=a.replace(j,"{N}");return a.replace(k,"{N}")}function m(a){a=a.getPath();var b=a.lastIndexOf(".");return b===-1?"":a.substring(b+1)}function n(){return i++}function o(a){a=new(g||(g=b("URI")))(a);var c=m(a);a.setQueryString("");a.setFragment("");if(c===""||c==="php"||c==="ico"){var d=l(a.getPath());d!==a.getPath()&&a.setPath(d+"/sanitized-"+n())}else b("FBLoomStaticResourceFileTypes").isStaticResourceFileType(c)||a.setPath("/sanitized"+(b("isCdnURI")(a)?"-cdn":"")+"-"+n()+"."+c);return a.toString()}function a(a){if(b("UserAgent").isBrowser("IE"))return"";h.has(a)||h.set(a,o(a));return h.get(a)||""}}),null);
__d("ResourceTimingLoomProvider",["clamp","gkx","performanceAbsoluteNow","sanitizeURIStringForLoom"],(function(a,b,c,d,e,f){"use strict";var g;function h(a){if(b("gkx")("1787898"))return b("sanitizeURIStringForLoom")(a);var c=a.indexOf("?");return c==-1?a:a.substring(0,c)}function i(a,b){b=b.substring(b.lastIndexOf(".")+1);if(b=="js"||b=="css")return b;else if(a=="img"||b=="png"||b=="jpg"||b=="ico")return"img";else return a}var j=function(){a.isSupported=function(){return window.performance&&window.performance.getEntriesByType&&window.performance.timing&&window.performance.timing.navigationStart};function a(a){this.$1=a}var c=a.prototype;c.$2=function(a){var c=a.entry,d=a.resourceName,e=a.resourceId,f=a.resourceType,g=a.startTime,h=a.endTime,i=this.$1;if(i!=null){var j=performance.timing.navigationStart;a=c;i.buffer.addEvent({type:"RESOURCE_TIMING_START",resourceType:f,resourceId:e,resourceName:d,encodedSize:a!=null&&typeof a.encodedBodySize==="number"?a.encodedBodySize:0,decodedSize:a!=null&&typeof a.decodedBodySize==="number"?a.decodedBodySize:0,transferSize:a!=null&&typeof a.transferSize==="number"?a.transferSize:0},g);d=function(a,c){c=c+j;i.buffer.addEvent({type:"RESOURCE_TIMING_POINT",resourceType:f,resourceId:e,pointName:a},b("clamp")(c,g,h))};d("requestStart",c.requestStart);d("responseStart",c.responseStart);i.buffer.addEvent({type:"RESOURCE_TIMING_END",resourceType:f,resourceId:e},h)}};c.loomTraceWillEnd=function(){var a=this,c=this.$1;if(c!=null){var d=c.startTime,e=(g||(g=b("performanceAbsoluteNow")))(),f=performance.timing.navigationStart;window.performance.getEntriesByType("resource").filter(function(a){return a.startTime<a.responseEnd&&a.startTime+f>=d&&a.responseEnd+f<=e}).forEach(function(g,c){var d=g.startTime+f,e=g.responseEnd+f,j=h(g.name),b=i(g.initiatorType,j);a.$2({entry:g,resourceName:j,resourceId:c,resourceType:b,startTime:d,endTime:e})});c=performance.getEntriesByType("navigation")[0];c=typeof PerformanceNavigationTiming!=="undefined"&&c instanceof PerformanceNavigationTiming?c:null;if(c!=null&&(c.responseEnd===0||c.responseEnd+f>=d)){var j="document",k=-1,l=d>f?d:f,m=c.responseEnd===0?e:c.responseEnd+f;this.$2({entry:c,resourceName:h(location.href),resourceId:k,resourceType:j,startTime:l,endTime:m})}}this.$1=null};return a}();e.exports={loomProviderId:"ResourceTiming",isSupported:function(){return j.isSupported()},getInstance:function(a){return new j(a)}}}),null);
__d("FBLoom",["Promise","requireCond","Banzai","CurrentUser","FBLoomEventBuffer","FBLoomSampling","FBLoomSerializer","cr:1094133","cr:955714","PerfXSharedFields","QPLLoomProvider","Random","ResourceTimingLoomProvider","SiteData","clearTimeout","gkx","ifRequired","performanceAbsoluteNow","performanceNavigationStart","performanceNow","promiseDone","recoverableViolation","setTimeoutAcrossTransitions","uuid"],(function(a,b,c,d,e,f){"use strict";var g,h,i=b("performanceNavigationStart")(),j=6e4,k=new Set(["InteractionTracing"]);a=function(){function a(){this.$4=[b("ResourceTimingLoomProvider"),b("QPLLoomProvider"),b("cr:1094133")].filter(Boolean),b("cr:955714")!=null&&b("cr:955714").isSupported()&&this.$4.push(b("cr:955714")),this.$3=new Set(this.$4.map(function(a){return a.loomProviderId})),this.$1=new Map(),this.$2=new Map(),this.$5=b("FBLoomSerializer").isSupported(),this.$6=!1,this.$7=1,this.$8=new Map(),this.$9=b("uuid")(),this.$10=1,this.$11=new Map(),this.$12=new Set()}var c=a.prototype;c.getNextSequenceNumber=function(){var a=this.$10;this.$10++;return a};c.getSessionId=function(){return this.$9};c.getActiveTraces=function(){return this.$1};c.addProvider=function(a){this.$3.has(a.loomProviderId)||(this.$4.push(a),this.$3.add(a.loomProviderId))};c.addStatusListener=function(a){var b=this,c=this.$7++;this.$8.set(c,a);return{dispose:function(){b.$8["delete"](c)}}};c.maybeStartTraceForInteraction=function(a,c,d,e,f){var g=b("FBLoomSampling").getSampleRate("INTERACTION",d,e);if(!b("Random").coinflip(g))return null;f=f+i;c={interaction_class:c,interaction_id:a,qpl_marker_id:String(d),sample_rate:g,trace_policy:e,type:"INTERACTION"};return this.startTrace(a,c,f,b("gkx")("1164245")?k:void 0)};c.endTraceForInteraction=function(a,c,d){var e=a.traceId,f=Object.assign({},a.metadata);f.qpl_action=c;c=a.completed;a=(a=a.markerPoints.visuallyComplete)==null?void 0:a.timestamp;c=Math.max((c=c)!=null?c:0,(c=a)!=null?c:0,(a=d)!=null?a:0);d=c>0?c:(g||(g=b("performanceNow")))();a=i+d;return this.endTrace(e,a,f)};c.$13=function(a,b,c,d){var e=a+"_"+b;a={type:"QPL",qpl_marker_id:String(a),qpl_instance_key:b,sample_rate:d};return this.startTrace(e,a,c)};c.maybeStartTraceForQPL=function(a,c,d){var e=b("FBLoomSampling").getSampleRate("QPL",a);return e&&b("Random").coinflip(e)?this.$13(a,c,d,e):null};c.maybeEndTraceForQPL=function(a,b,c,d){a=a+"_"+b;this.$1.has(a)&&this.endTrace(a,c,d)};c.startManualTrace=function(){this.$13(45088769,0,(h||(h=b("performanceAbsoluteNow")))(),1)};c.endManualTrace=function(){this.maybeEndTraceForQPL(45088769,0,(h||(h=b("performanceAbsoluteNow")))(),{qpl_action:2})};c.startTrace=function(a,c,d,e){var f=this;e===void 0&&(e=this.$3);if(!this.$5)return null;if(this.$1.has(a)){b("recoverableViolation")("Already running trace for triggerId: "+a,"web_loom");return null}var g=this.$10++,i={buffer:new(b("FBLoomEventBuffer"))(),triggerId:a,triggerInfo:c,startTime:d,sequenceNumber:g},k=new Set(),l=[];this.$4.forEach(function(a){e.has(a.loomProviderId)&&a.isSupported()&&(l.push(a.getInstance(i)),k.add(a.loomProviderId))});var m="STARTED";this.$1.set(a,{traceContext:i,providerInstances:l,status:m,startURI:window.location.href});this.$8.forEach(function(a){return a(i,m)});this.$11.set(a,b("setTimeoutAcrossTransitions")(function(){f.$12.add(a),f.endTrace(a,(h||(h=b("performanceAbsoluteNow")))(),{qpl_action:113,active_continuations:b("ifRequired")("JSTracing",function(b){return b.dumpActiveContinuations(a)},function(){return[]})})},j));c=this.$9+"_"+g;return{traceReferenceId:c,loomProviders:k}};c.endTrace=function(a,c,d){var e=this,f=this.$1.get(a);if(!f){this.$12.has(a)?this.$12["delete"](a):b("recoverableViolation")("No trace running for triggerId: "+a,"web_loom");return!1}var g=f.traceContext.sequenceNumber;this.$1["delete"](a);this.$2.set(g,f);this.$14(f,"END_PENDING");b("clearTimeout")(this.$11.get(a));var h=[];f.providerInstances.forEach(function(a){a=a.loomTraceWillEnd();a&&h.push(a)});var i=window.location.href;b("promiseDone")(b("Promise").all(h),function(){var a=b("PerfXSharedFields").getCommonData(),h=f.traceContext.triggerInfo;a={app_id:b("CurrentUser").getAppID(),start_time_us:Math.round(f.traceContext.startTime*1e3),end_time_us:Math.round(c*1e3),trigger_id:f.traceContext.triggerId,trigger_info:h,trigger_metadata:d,client_push_phase:a.client_push_phase,device_num_cores:a.num_cores,device_ram_bytes:a.ram_gb!=null?a.ram_gb*1073741824:null,is_rtl:a.isRTL,locale:a.locale,network_effective_connection_type:a.effective_connection_type,network_downlink_bps:a.downlink_megabits!=null&&a.downlink_megabits*1e6<1e20?a.downlink_megabits*1e6:null,network_rtt_ms:a.rtt_ms,client_rev:b("SiteData").client_revision,server_rev:b("SiteData").server_revision,spin_mode:b("SiteData").spin,start_uri:f.startURI,end_uri:i};a=b("FBLoomSerializer").serialize(a,f.traceContext.buffer,f.traceContext.jsSelfProfilerData);if(a!=null){a={trace:a,session_id:e.$9,sequence_number:f.traceContext.sequenceNumber,qpl_marker_id:h.qpl_marker_id,trace_policy:h.trace_policy,sample_rate:h.sample_rate};b("Banzai").post("loom_trace",a,{compress:!1,callback:function(){e.$14(f,"COMPLETE"),e.$2["delete"](g)},delay:e.$6?b("Banzai").VITAL_WAIT:b("Banzai").BASIC_WAIT});e.$14(f,"UPLOAD_PENDING")}else e.$14(f,"COMPLETE"),e.$2["delete"](g)},function(a){e.$14(f,"ERROR"),e.$2["delete"](g)});return!0};c.flush=function(a){var c=new Set(),d=new Set();this.$2.forEach(function(a){a.status==="END_PENDING"?c.add(a.traceContext.sequenceNumber):a.status==="UPLOAD_PENDING"&&d.add(a.traceContext.sequenceNumber)});if(c.size>0)var e=this.addStatusListener(function(d){c["delete"](d.sequenceNumber),c.size===0&&(b("Banzai").flush(a,a),e.dispose())});else d.size>0?b("Banzai").flush(a,a):a&&a()};c.setIsDevToolsConnected=function(a){this.$6=a};c.$14=function(a,b){a.status=b,this.$8.forEach(function(b){return b(a.traceContext,a.status)})};return a}();e.exports=new a()}),null);
__d("QPLLoomProvider",["QuickPerformanceLogger"],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(a){var c=this;this.$2={};this.$1=b("QuickPerformanceLogger").addListener({onMarkerStart:function(b,d,e){e>=a.startTime&&a.buffer.addEvent({type:"QPL_START",markerId:b,instanceKey:d},e),c.$2[b]||(c.$2[b]={}),c.$2[b][d]=e},onMarkerEnd:function(b,c,d,e){e>=a.startTime&&a.buffer.addEvent({type:"QPL_END",action:b,markerId:c,instanceKey:d},e)},onMarkerPoint:function(b,c,d,e,f){f>=a.startTime&&a.buffer.addEvent({type:"QPL_POINT",markerId:b,instanceKey:c,name:d,data:e},f)},onAnnotation:function(b,d,e,f){var g=c.$2[b];g=g==null?void 0:g[d];g!=null&&g>=a.startTime&&a.buffer.addEvent({type:"QPL_ANNOTATION",markerId:b,instanceKey:d,annotationKey:e,annotationValue:f},g)}})}var c=a.prototype;c.loomTraceWillEnd=function(){this.$1.dispose()};return a}();a={loomProviderId:"QPL",isSupported:function(){return!0},getInstance:function(a){return new g(a)}};e.exports=a}),null);
__d("PerfFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744178");c=b("FalcoLoggerInternal").create("perf",a);e.exports=c}),null);
__d("QPLTimestamp",[],(function(a,b,c,d,e,f){"use strict";f.calculateDurationAsNanoseconds=a;function a(a,b){b=b-a;if(b===0)return"0";a=b.toFixed(6).split(".",2);b=a[0];a=a[1];return b==="0"?a.replace(/^0+/,""):b+a}}),null);
__d("QPLCore",["QPLTimestamp"],(function(a,b,c,d,e,f){"use strict";function g(a,b,c,d){var e=b[a];if(!e||Object.entries(e).length===0)return null;if(!d){return b={},b[a]=Object.assign({},c&&c[a],e),b}var f={};Object.keys(e).forEach(function(a){var b=e[a];f[a]=d(b)});return b={},b[a]=Object.assign({},c&&c[a],f),b}function h(a,b){if(a==null)return b;a=Object.assign({},b,g("string",a,b),g("int",a,b,Math.trunc),g("double",a,b),g("bool",a,b),g("string_array",a,b),g("int_array",a,b,function(a){return a.map(Math.trunc)}),g("double_array",a,b),g("bool_array",a,b));return Object.entries(a).length!==0?a:null}function i(a){var b=Array.from(new Set(a.map(function(a){return a.name})));return b.map(function(b){return a.find(function(a){return a.name===b})}).filter(Boolean)}function j(a,b){return b===!0?babelHelpers["extends"]({},a,{tracked_for_loss:!0}):a}function k(a,b){if(!b)return a;var c={};b.string&&(c.annotations=b.string);b["int"]&&(c.annotations_int=b["int"]);b["double"]&&(c.annotations_double=b["double"]);b.bool&&(c.annotations_bool=b.bool);b.string_array&&(c.annotations_string_array=b.string_array);b.int_array&&(c.annotations_int_array=b.int_array);b.double_array&&(c.annotations_double_array=b.double_array);b.bool_array&&(c.annotations_bool_array=b.bool_array);return babelHelpers["extends"]({},a,c)}a=function(){function a(a){this.$2=1;this.$3=100;this.$4=new Map();this.$5=new Map();this.$8={};this.activeMarkers=new Map();this.$1=a;this.$7=a.logger;this.$5=(a=a.listenersWithMarker)!=null?a:new Map()}var c=a.prototype;c.getMarker=function(a,b){var c;if((c=this.$1.quickLogConfigHelper)==null?void 0:c.isKillswitchOn())return null;c=this.activeMarkers.get(a);if(!c)return null;a=c.get(b);return!a?null:a};c.addMarker=function(a,b,c){var d=this.activeMarkers.get(a);d||(d=new Map(),this.activeMarkers.set(a,d));d.set(b,c)};c.deleteMarker=function(a,b){(a=this.activeMarkers.get(a))==null?void 0:a["delete"](b)};c.markerStart=function(a,b,c,d){var e;b===void 0&&(b=0);c===void 0&&(c=this.currentTimestamp());d=d===void 0?{}:d;var f=d.cancelOnUnload;f=f===void 0?!1:f;var g=d.trackedForLoss;g=g===void 0?!1:g;d=d.type;d=d===void 0?1:d;if((e=this.$1.quickLogConfigHelper)==null?void 0:e.isKillswitchOn())return;this.getMarker(a,b)&&this.$7.warn("Duplicate QPL markerId: "+a+" & instanceKey: "+b);e=this.$9(a);var h=e[0];e=e[1];var i={passesSampling:h,timestamp:c,sampleRate:e,points:[],cancelOnUnload:f,trackedForLoss:g,type:d};this.$4.forEach(function(d){d.onMarkerStart(a,b,c)});this.$5.forEach(function(d){d.onMarkerStartWithMarker(a,b,c,i)});h&&this.addMarker(a,b,i);h&&g===!0&&this.$10({marker_id:27787271,action_id:0,sample_rate:1,annotations_int:{tracked_marker_id:a},marker_type:1})};c.markerAnnotate=function(a,b,c){c=c===void 0?{}:c;c=c.instanceKey;var d=c===void 0?0:c;this.$4.forEach(function(c){Object.keys(b).forEach(function(e){var f=b[e];if(!f)return;Object.keys(f).forEach(function(b){c.onAnnotation(a,d,b,f[b])})})});c=this.getMarker(a,d);if(!c)return;c.annotations=h(b,c.annotations)};c.markerPoint=function(a,b,c){c=c===void 0?{}:c;var d=c.instanceKey,e=d===void 0?0:d;d=c.data;var f=d===void 0?void 0:d;d=c.timestamp;var g=d===void 0?this.currentTimestamp():d;this.$4.forEach(function(c){return c.onMarkerPoint(a,e,b,f==null?void 0:(c=f.string)==null?void 0:c.__key,g)});c=this.getMarker(a,e);if(!c)return;d={name:b,timeSinceStart:Math.trunc(g-c.timestamp)};var i=h(f);i&&(d.data=i);c.points.push(d)};c.markerEnd=function(a,c,d,e){d===void 0&&(d=0);e===void 0&&(e=this.currentTimestamp());this.$4.forEach(function(b){return b.onMarkerEnd(c,a,d,e)});var f=this.getMarker(a,d);if(!f)return;if(f.passesSampling){if(f.timestampIsApproximate!==!0){var g=f.type===2?f.points:i(f.points);g={marker_id:a,action_id:c,instance_id:d,sample_rate:f.sampleRate,method:"random_sampling",duration_ns:b("QPLTimestamp").calculateDurationAsNanoseconds(f.timestamp,e),points:g,metadata:{application_analytics:{time_since_qpl_module_init:e-this.$1.moduleLoadTimestamp}},marker_type:f.type};g=k(g,f.annotations);g=j(g,f.trackedForLoss);this.$10(g)}this.$6===a&&this.$1.onDebuggingIdEnded&&this.$1.onDebuggingIdEnded()}this.deleteMarker(a,d)};c.markerDrop=function(a,b){b===void 0&&(b=0);this.deleteMarker(a,b);var c=this.currentTimestamp();this.$4.forEach(function(d){d.onMarkerDrop&&d.onMarkerDrop(a,b,c)})};c.markEvent=function(a,b,c,d){var e;d=d===void 0?{}:d;var f=d.timestamp;f=f===void 0?this.currentTimestamp():f;d=d.annotations;if((e=this.$1.quickLogConfigHelper)==null?void 0:e.isKillswitchOn())return;e=this.$9(a);var g=e[0];e=e[1];if(!g)return;g=h(typeof d==="function"?d():d);d={marker_id:a,action_id:0,instance_id:0,sample_rate:e,method:"random_sampling",da_type:b,da_level:c,metadata:{application_analytics:{time_since_qpl_module_init:f-this.$1.moduleLoadTimestamp}},marker_type:1};this.$10(k(d,g))};c.dropAllMarkers=function(){this.activeMarkers.clear()};c.setAlwaysOnSampleRate=function(a,b){this.$8[a]=b};c.currentTimestamp=function(){return this.$1.performanceNow()};c.enableDebug=function(a){this.$6=parseInt(a,10)};c.disableDebug=function(){this.$6=null};c.addListener=function(a){var b=this,c=this.$2++;this.$4.set(c,a);return{dispose:function(){b.$4["delete"](c)}}};c.$9=function(a){var b;if(this.$1.unsampleAllEvents&&this.$1.unsampleAllEvents()||this.$6===a)return[!0,1];b=(b=(b=this.$1.quickLogConfigHelper)==null?void 0:b.getEventDetails(a))!=null?b:{sampleRate:0};b=(a=(a=this.$8[a])!=null?a:b.sampleRate)!=null?a:this.$3;a=b!==0&&(b<=1||Math.random()*b<=1);return[a,b]};c.$10=function(a){var b=this.$1.decorateEventBeforeUpload?this.$1.decorateEventBeforeUpload(a):a;this.$1.sendEvent(a,b)};c.getActiveMarkerIDs=function(a){var b=a.type,c=[];this.activeMarkers.forEach(function(a,d){a.forEach(function(a){if(a.type===b){c.push(d);return}})});return c.sort()};return a}();e.exports=a;a.normalizeAnnotations=h}),null);
__d("QuickLogConfigHelper",["QuickLogConfig"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(){}var c=a.prototype;c.getEventDetails=function(a){return b("QuickLogConfig").qpl_events[a]};c.isKillswitchOn=function(){return b("QuickLogConfig").killswitch};return a}();e.exports=new a()}),null);
__d("QuickPerformanceLogger",["Promise","requireCond","Arbiter","Bootloader","Env","FBLogger","FBLoom","cr:1367102","PerfFalcoEvent","PerfXSharedFields","QPLCore","QuickLogConfigHelper","Run","WebStorage","gkx","performanceAbsoluteNow","performanceNavigationStart"],(function(a,b,c,d,e,f){"use strict";var g,h,i;function j(a){var c=b("PerfXSharedFields").getCommonData();c={memory_stats:{total_mem:c.ram_gb!=null?c.ram_gb*1073741824:null},network_stats:{downlink_megabits:c.downlink_megabits,network_subtype:c.effective_connection_type,rtt_ms:c.rtt_ms},sitedata_info:{client_push_phase:c.client_push_phase,client_revision:c.client_revision,server_revision:c.server_revision},locale_info:{locale:c.locale,isRTL:c.isRTL}};b("gkx")("1224637")&&(c.workplace_info={is_gemini:b("gkx")("1217157")});return babelHelpers["extends"]({},a,{metadata:babelHelpers["extends"]({},a.metadata,c)})}function k(a,c){return new(b("Promise"))(function(){var d=c||a;typeof window.__je2e_recordQPLMarker==="function"&&window.__je2e_recordQPLMarker(d);(g||(g=b("Env"))).enable_qplinspector===!0&&b("Bootloader").loadModules(["QPLInspector"],function(a){a.appendLog(d)},"QuickPerformanceLogger");b("gkx")("1554827")||b("gkx")("708253")?b("PerfFalcoEvent").logImmediately(function(){return d}):b("PerfFalcoEvent").log(function(){return d})})}function l(){return(g||(g=b("Env"))).enable_qplinspector===!0||typeof window.__je2e_recordQPLMarker==="function"||b("gkx")("1738486")}function m(){b("Arbiter").inform("qpl_debugger_finished")}var n=(h||(h=b("performanceAbsoluteNow")))(),o={debug:function(a,b,c){},warn:function(a){b("FBLogger")("qpl").blameToPreviousDirectory().warn(a)}},p="qpl",q=new Map();a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c;c=a.call(this,{quickLogConfigHelper:b("QuickLogConfigHelper"),decorateEventBeforeUpload:j,unsampleAllEvents:l,onDebuggingIdEnded:m,performanceNow:h||(h=b("performanceAbsoluteNow")),moduleLoadTimestamp:n,logger:o,sendEvent:k,listenersWithMarker:q})||this;c.$QuickPerformanceLogger1=100;c.$QuickPerformanceLogger2=1;b("Run").onUnload(function(){c.$QuickPerformanceLogger3(),c.$QuickPerformanceLogger4(706,{respectUnloadPolicy:!0,timestamp:c.currentTimestamp()})});c.$QuickPerformanceLogger5();c.initQplFlipperPlugin();c.initLoomStartTraceListener();c.initLoomEndTraceListener();return c}var d=c.prototype;d.$QuickPerformanceLogger5=function(){var a=this,c=(i||(i=b("WebStorage"))).getSessionStorageForRead();if(!c){this.$QuickPerformanceLogger6("_loadSavedState","sessionStorage is not available");return}var d=c.getItem(p);if(d==null)return;c.removeItem(p);c=JSON.parse(d);if(c==null){this.$QuickPerformanceLogger6("_loadSavedState","Saved state failed to deserialize");return}if(c.markers==null||c.markers.length===0){this.$QuickPerformanceLogger6("_loadSavedState","No saved markers found");return}c.markers.forEach(function(b){var c=b[0],d=b[1];b=b[2];a.addMarker(c,d,b);a.$QuickPerformanceLogger6("_loadSavedState","Marker "+c+" (instanceKey: "+d+") resumed")})};d.$QuickPerformanceLogger3=function(){var a=this,c=[];this.activeMarkers.forEach(function(a,b){a.forEach(function(a,d){a.resumeAfterNavigation===!0&&(delete a.resumeAfterNavigation,c.push([b,d,a]))})});if(c.length>0){var d={markers:c},e=(i||(i=b("WebStorage"))).getSessionStorage();e=i.setItemGuarded(e,p,JSON.stringify(d));e&&(c.forEach(function(b){var c=b[0];b=b[1];a.markerEnd(c,96,b)}),this.$QuickPerformanceLogger6("_storeSavedState","Failed to store saved state: "+e.message),b("FBLogger")("qpl").catching(e).warn("Failed to store QPL state: "+JSON.stringify(d,null,2)));c.forEach(function(b){var c=b[0];b=b[1];a.deleteMarker(c,b)})}};d.markerStoreBeforeNavigation=function(a,b){b=b===void 0?{}:b;b=b.instanceKey;b=b===void 0?0:b;a=this.getMarker(a,b);if(!a)return;a.resumeAfterNavigation=!0};d.markerStartFromNavStart=function(a,c,d){c===void 0&&(c=0);d=d===void 0?{}:d;var e=d.cancelOnUnload;e=e===void 0?!1:e;var f=d.trackedForLoss;f=f===void 0?!1:f;d=d.type;d=d===void 0?1:d;var g=b("performanceNavigationStart")();this.markerStart(a,c,g,{cancelOnUnload:e,trackedForLoss:f,type:d});if(b("performanceNavigationStart").isPolyfilled){g=this.getMarker(a,c);g&&(g.timestampIsApproximate=!0)}};d.$QuickPerformanceLogger4=function(a,b){var c=this;b=b===void 0?{}:b;var d=b.timestamp,e=b.respectUnloadPolicy;this.activeMarkers.forEach(function(b,f){b.forEach(function(b,g){(!e||b.cancelOnUnload===!0)&&c.markerEnd(f,a,g,d)})})};d.$QuickPerformanceLogger6=function(a,b,c){o.debug(a,b,c)};d.initQplFlipperPlugin=function(){b("cr:1367102")!=null&&this.addListener(b("cr:1367102").qplFlipperPlugin.listener())};d.initLoomEndTraceListener=function(){var a=this;this.addListener({onMarkerStart:function(){},onMarkerEnd:function(c,d,e,f){var g=a.getMarker(d,e);if(!g)return;b("FBLoom").maybeEndTraceForQPL(d,e,f,Object.assign({qpl_action:c},(d=g.annotations)==null?void 0:d.string,(e=g.annotations)==null?void 0:e["int"],(f=g.annotations)==null?void 0:f["double"],(c=g.annotations)==null?void 0:c.bool,(d=g.annotations)==null?void 0:d.string_array,(e=g.annotations)==null?void 0:e.int_array,(f=g.annotations)==null?void 0:f.double_array,(c=g.annotations)==null?void 0:c.bool_array))},onMarkerPoint:function(){},onAnnotation:function(){},onMarkerDrop:function(a,c,d){b("FBLoom").maybeEndTraceForQPL(a,c,d,{qpl_action:216})}})};d.initLoomStartTraceListener=function(){var a=this;this.$QuickPerformanceLogger7({onMarkerStartWithMarker:function(c,d,e,f){e=b("FBLoom").maybeStartTraceForQPL(c,d,e);var g=e==null?void 0:e.loomProviders;e=e==null?void 0:e.traceReferenceId;!f.passesSampling&&e!=null&&a.addMarker(c,d,f);e!=null&&a.markerAnnotate(c,{string:{loomRefId:e}},{instanceKey:d});g!=null&&a.markerAnnotate(c,{string_array:{loomProviders:Array.from(g)}},{instanceKey:d})}})};d.$QuickPerformanceLogger7=function(a){var b=this.$QuickPerformanceLogger2++;q.set(b,a);return{dispose:function(){q["delete"](b)}}};return c}(b("QPLCore"));c=new a();e.exports=c}),null);
__d("MStoriesMediaLoaded",["Event","QuickPerformanceLogger","Run"],(function(a,b,c,d,e,f){"use strict";a=function(){a.getInstance=function(){this.$1||(this.$1=new a());return this.$1};function a(){var c=this;this.$2=[];this.$3=function(){c.$5(),a.$1=null};b("Run").onLeave(this.$3)}a.init=function(b){a.getInstance().setup(b.photo)};var c=a.prototype;c.$4=function(){var a;(a=b("QuickPerformanceLogger")).markerEnd(13238354,2);a.markerEnd(13238356,2);a.markerEnd(13238313,2);a.markerEnd(13238373,2)};c.setup=function(a){var c=this;this.$5();this.$2=[];a!=null&&(a instanceof HTMLImageElement&&a.complete?this.$4():this.$2.push(b("Event").listen(a,"load",function(){c.$4()})))};c.$5=function(){this.$2.forEach(function(a){return a.remove()})};return a}();e.exports=a;a.$1=null}),null);
__d("MStoriesDOMUtils",["Bootloader","DOM"],(function(a,b,c,d,e,f){"use strict";f.find=a;function a(a,c,d){a=b("DOM").scry(a,c,d);if(a.length===0){b("Bootloader").loadModules(["FBLogger"],function(a){a("fbstories").mustfix("Failed to load dom element with tag %s and sigil %s",c,d||"")},"MStoriesDOMUtils");return null}return a[0]}}),null);
__d("MStoriesGating",["MFBStoriesGatingConfig","gkx","qex"],(function(a,b,c,d,e,f){"use strict";f.genShouldShowTextOverlays=a;f.genShouldShowStoriesEffects=c;f.shouldMockLogging=d;f.shouldShowOptimisticPreviews=e;f.shouldShowNTViewerSheet=g;function a(){return b("MFBStoriesGatingConfig").enableTextOverlayProduction}function c(){return b("gkx")("676799")}function d(){return b("gkx")("1260876")}function e(){return b("gkx")("676800")}function g(){return b("qex")._("863251")}}),null);
__d("MStoriesHideHeaderListener",["Bootloader","MArrays","MStoriesUIConstants","Stratcom","URI"],(function(a,b,c,d,e,f){"use strict";var g,h="m:page:render:start";a={_hideHeaderListener:null,setup:function(){var a=this;if(this._hideHeaderListener)return;this._hideHeaderListener=b("Stratcom").listen(h,null,function(c){c=new(g||(g=b("URI")))(c.getData().path);c=c.getPath();b("MArrays").findPrefix(b("MStoriesUIConstants").HIDE_HEADER_URLS,c)&&(b("Bootloader").loadModules(["MStoriesDisplayUtils"],function(a){a.toggleChromeBar(!1)},"MStoriesHideHeaderListener"),b("Stratcom").removeCurrentListener(),a._hideHeaderListener=null)})}};e.exports=a}),null);
__d("MStoriesProductionTrayUtils",["cx","CSS","MFBStoriesGatingConfig","MStoriesDOMUtils","MStoriesProductionInfo","MStoriesUploadStatus"],(function(a,b,c,d,e,f,g){"use strict";var h={getAnimationPog:function(){var a=document.getElementById("m-stories-owner-bucket-pog");return a?a:document.getElementById("m-stories-add-item-pog")},getUploadingClass:function(){var a=b("MFBStoriesGatingConfig").trayType;return a==="nine_by_sixteen"?"loading":"_1zpf"},updateProductionPog:function(){var a=b("MStoriesProductionInfo").getUploadStatus();if(a===b("MStoriesUploadStatus").UPLOADING){var c=h.getAnimationPog(),d=document.getElementById("m-stories-add-item-pog"),e=document.getElementById("m-stories-add-item"),f=document.getElementById("m-stories-owner-bucket-pog"),g=h.getUploadingClass();c&&(b("CSS").addClass(c,g),c.id==="m-stories-owner-bucket-pog"?(d&&b("CSS").removeClass(d,g),e&&b("CSS").addClass(e,"disable")):(f&&b("CSS").removeClass(f,g),e&&b("CSS").removeClass(e,"disable")))}c=b("MFBStoriesGatingConfig").trayType;if(c!=="circular"){d=document.getElementById("m-stories-owner-bucket");if(d){f=d.getAttribute("data-is-optimistic-item")!=null;g=a===b("MStoriesUploadStatus").UPLOADING||a===b("MStoriesUploadStatus").FAILED;f&&(g?b("CSS").removeClass(d,"hidden"):b("CSS").addClass(d,"hidden"))}this._updateProductionItemText()}this._updateErrorState()},_updateProductionItemText:function(){var a=document.getElementById("m-stories-owner-bucket");if(!a)return;var c=b("MStoriesDOMUtils").find(a,"div","m-stories-rectangular-item-title");a=b("MStoriesDOMUtils").find(a,"div","m-stories-rectangular-item-adding-story-title");if(c&&a){var d=b("MStoriesProductionInfo").getUploadStatus();switch(d){case b("MStoriesUploadStatus").UPLOADING:b("CSS").addClass(c,"hidden");b("CSS").removeClass(a,"hidden");break;default:b("CSS").addClass(a,"hidden");b("CSS").removeClass(c,"hidden");break}}},_updateErrorState:function(){var a=b("MStoriesProductionInfo").getUploadStatus(),c=b("MFBStoriesGatingConfig").trayType;switch(c){case"fblite_with_profile_pog":c=document.getElementById("m-stories-owner-bucket");if(c!=null){var d=b("MStoriesDOMUtils").find(c,"div","m-stories-rectangular-item-count");c=b("MStoriesDOMUtils").find(c,"div","m-stories-rectangular-item-count-error");d&&c&&(a===b("MStoriesUploadStatus").FAILED?(b("CSS").addClass(d,"hiddenByError"),b("CSS").removeClass(c,"hidden")):(b("CSS").removeClass(d,"hiddenByError"),b("CSS").addClass(c,"hidden")))}break;case"mobile_three_by_one":d=this.getAnimationPog();a===b("MStoriesUploadStatus").FAILED?b("CSS").addClass(d,"_6y1s"):b("CSS").removeClass(d,"_6y1s");break;case"nine_by_sixteen":c=this.getAnimationPog();d=document.getElementById("m-stories-owner-title");a===b("MStoriesUploadStatus").FAILED?(b("CSS").addClass(c,"error"),d&&b("CSS").addClass(d,"error")):(b("CSS").removeClass(c,"error"),d&&b("CSS").removeClass(d,"error"));break;default:c=this.getAnimationPog();c&&(a===b("MStoriesUploadStatus").FAILED?b("CSS").addClass(c,"_4ts1"):b("CSS").removeClass(c,"_4ts1"));break}}};e.exports=h}),null);
__d("MStoriesTrayInfo",[],(function(a,b,c,d,e,f){"use strict";a={_hasNextPage:{},_trayBucketIDs:{},_trayTrackingStrings:{},_trayNeedsRefresh:!1,setTrayBucketIDs:function(a){var b=this._getKey(a.key);this._trayBucketIDs[b]=a.bucketIDs;this._hasNextPage[b]=a.hasNextPage;this._trayTrackingStrings[b]=a.trackingStrings},appendTrayBucketIDs:function(a){var b=this._getKey(a.key);this._trayBucketIDs[b]==null&&(this._trayBucketIDs[b]=[]);this._trayBucketIDs[b]=this._trayBucketIDs[b].concat(a.bucketIDs);this._trayTrackingStrings[b]==null&&(this._trayTrackingStrings[b]=[]);this._trayTrackingStrings[b]=this._trayTrackingStrings[b].concat(a.trackingStrings);this._hasNextPage[b]=a.hasNextPage},getTrayBucketIDs:function(a){a=this._getKey(a);return this._trayBucketIDs[a]},getTrayTrackingStrings:function(a){a=this._getKey(a);return this._trayTrackingStrings[a]||[]},getHasNextPage:function(a){a=this._getKey(a);return!!this._hasNextPage[a]},_getKey:function(a){return a==null?"top_of_feed":a},setTrayNeedsRefresh:function(a){this._trayNeedsRefresh=a},getTrayNeedsRefresh:function(){return this._trayNeedsRefresh}};e.exports=a}),null);
__d("MStoriesTrayUIConstants",[],(function(a,b,c,d,e,f){"use strict";a=20;f.REDIRECT_DELAY_IN_MS=a}),null);
__d("MStoriesTrayAsync",["cx","requireCond","Bootloader","CSS","DOM","MFBStoriesGatingConfig","MFBStoriesOptimisticTrayGatedModule","MPageController","MStoriesDOMUtils","MStoriesGating","MStoriesHideHeaderListener","MStoriesProductionTrayUtils","MStoriesStratcomEvents","cr:710451","MStoriesTrayInfo","MStoriesTrayUIConstants","QuickPerformanceLogger","Run","Stratcom","URI","WebFunnelLogger"],(function(a,b,c,d,e,f,g){var h,i=b("MFBStoriesOptimisticTrayGatedModule").module,j="m:page:render:cache:complete-with-replays";a={_currentItemLoading:null,_listeners:[],_spinner:null,_feedUnitURIs:[],registerFeedUnitWithUri:function(a){this._feedUnitURIs.push(a.uri),this._init()},updateSpinner:function(a){this._spinner=a.spinner,this._init()},_init:function(){var a=this;if(this._listeners.length>0)return;this._listeners=[b("Stratcom").listen(j,null,function(){if(!b("MStoriesTrayInfo").getTrayNeedsRefresh())return;b("Bootloader").loadModules(["MStoriesTrayUtils"],function(b){b.refreshTray(),b.refreshFeedUnitsWithURIs(a._feedUnitURIs)},"MStoriesTrayAsync")}),b("Stratcom").listen("click","m-stories-tray-archive-link",this._openArchive),b("Stratcom").listen("click","m-stories-tray-pog-container",function(b){a._openPOG(b)}),b("Stratcom").listen("keypress","m-stories-tray-pog-container",function(b){var c=b.getSpecialKey();(c==="return"||c==="space")&&(b.prevent(),a._openPOG(b))}),b("Stratcom").listen(b("MStoriesStratcomEvents").UPLOAD_SUCCESS,null,function(a){a=a.getData()||{};i&&i.handleUploadSuccess(a.newThreadID,a.optimisticThreadID)})];b("MStoriesHideHeaderListener").setup();i&&i.initializeOnTrayLoad();b("MStoriesProductionTrayUtils").updateProductionPog();b("Run").onLeave(function(){a._destroy()})},_openArchive:function(a){a=a.getNode("m-stories-tray-archive-link");if(a!=null){var c=a.getAttribute("data-href");c&&window.setTimeout(function(){b("MPageController").load(c,{hideLoadingIndicator:!1})})}},_openPOG:function(a){var c=this,d=a.getNode("m-stories-tray-pog-container");if(this._currentItemLoading){if(this._currentItemLoading===d)return;this._setLoadingStateHidden(this._currentItemLoading,!0)}if(!d)return;d.id==="m-stories-owner-bucket"?b("Bootloader").loadModules(["MStoriesProductionTrayAsync"],function(a){if(!d)return;if(a.handleFailedAddToStoryPogSelected())return;c._openViewer(d)},"MStoriesTrayAsync"):this._openViewer(d)},_setLoadingStateHidden:function(a,c){var d=b("MFBStoriesGatingConfig").trayType,e=c?b("CSS").removeClass:b("CSS").addClass;switch(d){case"circular":e(a,"loading");break;case"fblite_with_profile_pog":e(a,"_6pvo");break;case"nine_by_sixteen":case"mobile_three_by_one":a=b("MStoriesDOMUtils").find(a,"div","m-stories-tray-pog");if(a){if(c&&a.id==="m-stories-owner-bucket-pog")return;d==="nine_by_sixteen"?e(a,"loading"):e(a,"_1zpf")}break}},_openViewer:function(a){this._currentItemLoading=a;var c=b("MFBStoriesGatingConfig").trayType;c=c!=="circular";b("QuickPerformanceLogger").markerEnd(13238313,4);b("QuickPerformanceLogger").markerStart(13238313);if(!c){c=b("MStoriesDOMUtils").find(a,"i","m-stories-tray-pog-picture");c!=null&&b("DOM").insertAfter(c,this._spinner)}var d=a.getAttribute("data-href");b("MStoriesGating").shouldShowOptimisticPreviews()&&a.id==="m-stories-owner-bucket"&&i&&(d=i.getURI(a));if(d){c=new(h||(h=b("URI")))(d);c=c.getQueryData();var e=c.tray_session_id;new(b("WebFunnelLogger"))("FBStoriesMTouchTrayViewerFunnelDefinition").addFunnelPayload("tray_index",c.selected_bucket_index).setSessionKey((c=e)!=null?c:"null").setAction("Tray item select").log();this._setLoadingStateHidden(a,!1);window.setTimeout(function(){b("MPageController").load(d,{hideLoadingIndicator:!0});var a=b("Stratcom").listen("m:page:iui:response:complete",null,function(c){c=c.getData()||{};c=c.path;if(c==null||!c.includes("stories/view_tray"))return;new(b("WebFunnelLogger"))("FBStoriesMTouchTrayViewerFunnelDefinition").setSessionKey((c=e)!=null?c:"null").setAction("Viewer rendered").markEnd().log();a.remove()})},b("MStoriesTrayUIConstants").REDIRECT_DELAY_IN_MS)}},_destroy:function(){var a=b("MStoriesProductionTrayUtils").getAnimationPog();a&&b("CSS").removeClass(a,b("MStoriesProductionTrayUtils").getUploadingClass());this._listeners.forEach(function(a){return a.remove()});this._listeners=[]}};e.exports=a}),null);
__d("MFeedRefresh",["Event","MAnimatedScroll","MHome","MPageController","MViewport","Stratcom","SubscriptionsHandler","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";f.reloadFeed=q;f.reloadFeedIfNeeded=t;f.init=a;var g="/home.php",h=!1,i=!1,j=new(b("SubscriptionsHandler"))(),k=null,l=null,m=0,n=!1,o=500;function p(a){b("MViewport").scrollToTop(),b("MPageController").forceLoad(a)}function q(a){var c=g,d=!1;a&&(a.feedPath!==null&&a.feedPath!==void 0&&(c=a.feedPath),d=!!a.animate);if(d&&a){d=a.animationDuration===null||a.animationDuration===void 0?o:a.animationDuration;b("MAnimatedScroll").scrollToTop({duration:d},function(){p(c)})}else p(c)}function r(){m=0,k&&(b("clearTimeout")(k),k=null)}function s(){r(),i&&(j.release(),j.engage())}function t(a){if(!b("MHome").isHome())return!1;var c=!0;if(a&&m&&l!==null){a=Date.now()-m;c=a>=l}if(!c)return!1;s();q();return!0}function u(){r(),m=Date.now(),k=b("setTimeoutAcrossTransitions")(function(){t(!1)},l)}function v(){var a=t(!0);a||u()}function w(){s();var a=b("MHome").isHome();if(!a)return;u();i&&(j.addSubscriptions(b("Event").listen(document,"touchstart",v,!0)),n&&j.addSubscriptions(b("Event").listen(document,"mousedown",v,!0)))}function x(a,c){c===void 0&&(c=!1);if(a<=0)return;l=a*60*1e3;i=c;b("Stratcom").listen("history:change",null,w);w()}function a(a){if(h)return;x(a.intervalMinutes,a.resetOnTouch);h=!0}}),null);
__d("Time",[],(function(a,b,c,d,e,f){a={getGMTOffset:function(a){var b=new Date(),c=b.getTimezoneOffset()/30;b=b.getTime()/1e3;a=Math.round((a-b)/1800);b=Math.round(c+a)%48;b>24?b-=Math.ceil(b/48)*48:b<-28&&(b+=Math.ceil(b/-48)*48);return b*30}};e.exports=a}),null);
__d("XRelatedApplicationsLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/related-application/",{call_success:{type:"Bool",defaultValue:!1},checked_installed_related_apps:{type:"StringKeyset",defaultValue:[]},present_installed_related_apps:{type:"StringKeyset",defaultValue:[]}})}),null);
__d("MRelatedApplicationsLogging",["MRequest","XRelatedApplicationsLoggingController","getInstalledRelatedApps","promiseDone"],(function(a,b,c,d,e,f){f.init=a;var g=b("XRelatedApplicationsLoggingController").getURIBuilder();function a(a){b("promiseDone")(b("getInstalledRelatedApps")(),function(c){g.setStringKeyset("checked_installed_related_apps",a);if(c!=null&&c.length>0){g.setBool("call_success",!0);c=c.map(function(a){return a.id});g.setStringKeyset("present_installed_related_apps",c)}else g.setBool("call_success",!1);new(b("MRequest"))(g.getURI()).setIgnoreErrors(!0).send()})}}),null);
__d("TimezoneAutoset",["MRequest","Time"],(function(a,b,c,d,e,f){var g;a=function(a){if(g)return;g=!0;if(!a.time||a.offset===void 0)return;var c=-b("Time").getGMTOffset(a.time);(a.forceUpdate||c!=a.offset)&&new(b("MRequest"))(a.uri).setMethod("POST").setData({offset:c,is_forced:a.forceUpdate}).send()};f.main=a}),null);